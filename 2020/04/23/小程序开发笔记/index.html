<!DOCTYPE html>
<html lang="en">

<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8">
	<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
	
	<!-- title -->
	
	<title>
	
		小程序开发笔记 | 
	 
	Been&#39;s Blog
	</title>
	
	<!-- keywords,description -->
	 
		<meta name="description" content="my markdown blog" />
	

	<!-- favicon -->
	
	<link rel="shortcut icon" href="/favicon.ico">
	
  

	
<link rel="stylesheet" href="/css/main.css">

	
<link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.min.css">

	
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.17.1/build/styles/darcula.min.css">


	
<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.17.1/build/highlight.min.js"></script>

	
<script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>

	
<script src="https://cdn.jsdelivr.net/npm/jquery-pjax@2.0.1/jquery.pjax.min.js"></script>

	
<script src="/js/main.js"></script>

	
		
<script src="https://cdn.jsdelivr.net/npm/leancloud-storage/dist/av-min.js"></script>

		
<script src="https://cdn.jsdelivr.net/npm/valine@1.3.10/dist/Valine.min.js"></script>

	
	
		<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
	
<meta name="generator" content="Hexo 4.2.0"></head>

<body>
	<header id="header">
    <a id="title" href="/" class="logo">Been's Blog</a>

	<ul id="menu">
		<li class="menu-item">
			<a href="/about" class="menu-item-link">ABOUT</a>
		</li>
		
		<li class="menu-item">
			<a href="https://github.com/wujun234/uid-generator-spring-boot-starter" class="menu-item-link" target="_blank">
				UidGenerator
			</a>
		</li>
		<li class="menu-item">
			<a href="https://github.com/BeenStone01" class="menu-item-link" target="_blank">
				<i class="fa fa-github fa-2x"></i>
			</a>
		</li>
	</ul>
</header>

	
<div id="sidebar">
	<button id="sidebar-toggle" class="toggle" ><i class="fa fa-arrow-right " aria-hidden="true"></i></button>
	
	<div id="site-toc">
		<input id="search-input" class="search-input" type="text" placeholder="search...">
		<div id="tree">
			

			
							<ul>
								<li class="file">
									<a href="/2020/04/23/C++%E4%BB%A3%E7%A0%81%E6%A0%B7%E4%BE%8B/">
										C++代码样例
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2020/07/19/GPIB/">
										GPIB
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2020/04/23/Laravel/">
										Laravel
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2020/04/24/Linux%E5%9C%A8%E7%BA%BF/">
										Linux在线
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2020/04/29/MFC/">
										MFC
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2020/04/29/MFC%E5%A4%9A%E7%BA%BF%E7%A8%8B/">
										MFC多线程
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2020/04/23/MFC%E8%87%AA%E7%BB%98%E6%8C%89%E9%92%AE/">
										MFC自绘按钮
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2020/04/23/MFC%E8%87%AA%E7%BB%98%E6%A6%82%E8%BF%B0/">
										MFC自绘概述
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2020/04/23/SSDP%E5%BC%80%E5%8F%91%E8%AF%B4%E6%98%8E/">
										SSDP开发说明
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2020/04/23/STL_vector/">
										STL_vector
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2020/04/23/STL/">
										STL
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2020/04/23/WinHttp%E4%BD%BF%E7%94%A8%E8%AF%A6%E8%A7%A3/">
										WinHttp使用详解
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2020/04/23/WinInet%E4%BD%BF%E7%94%A8%E8%AF%A6%E8%A7%A3/">
										WinInet使用详解
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2020/04/23/Wininte%E6%A0%B7%E4%BE%8B%E8%A7%A3%E6%9E%90/">
										Wininte样例解析
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2020/04/26/XML%E4%B9%8BIXMLHTTPReuest/">
										XML之IXMLHTTPReuest
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2020/04/23/XML%E6%93%8D%E4%BD%9C%E4%B9%8BCMarkUp/">
										XML操作之CMarkUp
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2020/04/23/XML%E8%A7%A3%E6%9E%90/">
										XML解析
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2020/04/23/c++11/">
										c++11
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2020/07/06/c++%E5%B0%8F%E7%A8%8B%E5%BA%8F/">
										c++小程序
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2020/04/26/c-%E6%9C%AA%E5%BD%92%E7%B1%BB%E4%BB%A3%E7%A0%81/">
										c-未归类代码
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2020/04/23/hexo/">
										hexo
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2020/04/23/socket/">
										socket
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2020/04/24/thread-2/">
										thread-2
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2020/04/23/thread/">
										thread
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2020/04/23/vue%E7%AC%94%E8%AE%B0/">
										vue笔记
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2020/04/23/webpack%E4%BD%BF%E7%94%A8/">
										webpack使用
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2020/04/30/%E4%B8%B2%E5%8F%A3com%E7%BC%96%E7%A8%8B/">
										串口com编程
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2020/05/03/%E5%88%B7%E9%A2%98%E7%BA%AA%E5%BD%95/">
										刷题纪录
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2020/04/23/%E5%AD%97%E7%AC%A6%E7%B1%BB%E5%9E%8B/">
										字符类型
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file active">
									<a href="/2020/04/23/%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%BC%80%E5%8F%91%E7%AC%94%E8%AE%B0/">
										小程序开发笔记
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2020/04/24/%E5%B8%B8%E7%94%A8%E5%B7%A5%E5%85%B7%E5%91%BD%E4%BB%A4/">
										常用工具命令
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2020/04/23/%E6%96%87%E4%BB%B6%E8%AF%BB%E5%86%99/">
										文件读写
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2020/04/23/%E7%BC%96%E7%A0%81%E6%A0%BC%E5%BC%8F%E8%BD%AC%E6%8D%A2/">
										编码格式转换
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
		</div>
	</div>
</div>

	<!-- 引入正文 -->
	<div id="content">
		<h1 id="article-title">

	小程序开发笔记
</h1>
<div class="article-meta">
	
	<span>Been Stone</span>
	<span>2020-04-23 17:08:18</span>
    
		<div id="article-categories">
            
		</div>
    
</div>

<div id="article-content">
	<h1 id="笔记"><a href="#笔记" class="headerlink" title="笔记"></a>笔记</h1><h2 id="wxss样式布局"><a href="#wxss样式布局" class="headerlink" title="wxss样式布局"></a>wxss样式布局</h2><h3 id="自适应布局"><a href="#自适应布局" class="headerlink" title="自适应布局"></a>自适应布局</h3><h4 id="rpx"><a href="#rpx" class="headerlink" title="rpx"></a>rpx</h4><p>屏幕总宽度750rpx<br>90vh 屏幕高度的90%<br>属性用单引号</p>
<h3 id="样例代码"><a href="#样例代码" class="headerlink" title="样例代码"></a>样例代码</h3><p>自定义数据<br>data-user-id -&gt; data: userId<br>wxml</p>
<pre><code class="xml">&lt;view bindtap=&#39;f1&#39;&gt;
    &lt;text wx:if=&quot;{{index > 0}}&quot;&gt;
    &lt;/text&gt;
&lt;/view&gt;
{{wx:for}}  index,item
&lt;swiper indicator-dots=&#39;{{true}}&#39; previous-margin=&quot;50px&quot; next-margin=&quot;50px&quot;&gt;
&lt;swiper-item wx:for=&quot;{{todoList}}&quot;&gt;
123
&lt;/swiper-item&gt;
&lt;swiper-item&gt;
456
&lt;/swiper-item&gt;
&lt;/swiper&gt;</code></pre>
<p>bindtap(冒泡),catchtap(不冒泡)</p>
<pre><code class="js">onLoad:function(options){
    this.setData({
        currentIndex: this.data.weeklyMovieList.length - 1,
        &quot;weeklyMovieList[2].name&quot;: &quot;教父3&quot;
    })
}

f0:function(event){
    this.setData({
        currentIndex:this.data.weeklyMovieList.length-1
    })
}

f1:function(event){
    var movieId = event.currentTarget.dataset.movieId
    wx.navigateTo({
        url:&#39;/pages/detail/detail&#39;+ movieId
        })
}

//Detail.js
Page({
    onLoad:function(options){
        console.log(options.id);
        this.setData({
            mid:options.id
        })
    }
})</code></pre>
<h2 id="用户登录-获取用户openid"><a href="#用户登录-获取用户openid" class="headerlink" title="用户登录(获取用户openid)"></a>用户登录(获取用户openid)</h2><p>config.json</p>
<pre><code class="js">{
  &quot;permissions&quot;: {
    &quot;openapi&quot;: []
  }
}</code></pre>
<p>index.js</p>
<pre><code class="js">// 云函数模板
// 部署：在 cloud-functions/login 文件夹右击选择 “上传并部署”

const cloud = require(&#39;wx-server-sdk&#39;)

// 初始化 cloud
cloud.init({
  // API 调用都保持和云函数当前所在环境一致
  env: cloud.DYNAMIC_CURRENT_ENV
})

/**
 * 这个示例将经自动鉴权过的小程序用户 openid 返回给小程序端
 * 
 * event 参数包含小程序端调用传入的 data
 * 
 */
exports.main = (event, context) =&gt; {
  console.log(event)
  console.log(context)

  // 可执行其他自定义逻辑
  // console.log 的内容可以在云开发云函数调用日志查看

  // 获取 WX Context (微信调用上下文)，包括 OPENID、APPID、及 UNIONID（需满足 UNIONID 获取条件）等信息
  const wxContext = cloud.getWXContext()

  return {
    event,
    openid: wxContext.OPENID,
    appid: wxContext.APPID,
    unionid: wxContext.UNIONID,
    env: wxContext.ENV,
  }
}</code></pre>
<p>package.js</p>
<pre><code class="js">{
  &quot;name&quot;: &quot;login&quot;,
  &quot;version&quot;: &quot;1.0.0&quot;,
  &quot;description&quot;: &quot;&quot;,
  &quot;main&quot;: &quot;index.js&quot;,
  &quot;scripts&quot;: {
    &quot;test&quot;: &quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;
  },
  &quot;author&quot;: &quot;&quot;,
  &quot;license&quot;: &quot;ISC&quot;,
  &quot;dependencies&quot;: {
    &quot;wx-server-sdk&quot;: &quot;~1.8.3&quot;
  }
}</code></pre>
<h2 id="数据库操作"><a href="#数据库操作" class="headerlink" title="数据库操作"></a>数据库操作</h2><h3 id="数据库设计"><a href="#数据库设计" class="headerlink" title="数据库设计"></a>数据库设计</h3><p>表一：用户信息存储[open_id, name, avatar(头像地址)]<br>表二：待办事项存储[id, open_id, thing, done]</p>
<h3 id="样例代码-1"><a href="#样例代码-1" class="headerlink" title="样例代码"></a>样例代码</h3><pre><code class="js">const app = getApp()

Page({

  data: {
    step: 1,
    counterId: &#39;&#39;,
    openid: &#39;&#39;,
    count: null,
    queryResult: &#39;&#39;,
  },

  onLoad: function (options) {
    if (app.globalData.openid) {
      this.setData({
        openid: app.globalData.openid
      })
    }
  },

  onAdd: function () {
    const db = wx.cloud.database()
    db.collection(&#39;counters&#39;).add({
      data: {
        count: 1
      },
      success: res =&gt; {
        // 在返回结果中会包含新创建的记录的 _id
        this.setData({
          counterId: res._id,
          count: 1
        })
        wx.showToast({
          title: &#39;新增记录成功&#39;,
        })
        console.log(&#39;[数据库] [新增记录] 成功，记录 _id: &#39;, res._id)
      },
      fail: err =&gt; {
        wx.showToast({
          icon: &#39;none&#39;,
          title: &#39;新增记录失败&#39;
        })
        console.error(&#39;[数据库] [新增记录] 失败：&#39;, err)
      }
    })
  },

  onQuery: function() {
    const db = wx.cloud.database()
    // 查询当前用户所有的 counters
    db.collection(&#39;counters&#39;).where({
      _openid: this.data.openid
    }).get({
      success: res =&gt; {
        this.setData({
          queryResult: JSON.stringify(res.data, null, 2)
        })
        console.log(&#39;[数据库] [查询记录] 成功: &#39;, res)
      },
      fail: err =&gt; {
        wx.showToast({
          icon: &#39;none&#39;,
          title: &#39;查询记录失败&#39;
        })
        console.error(&#39;[数据库] [查询记录] 失败：&#39;, err)
      }
    })
  },

  onCounterInc: function() {
    const db = wx.cloud.database()
    const newCount = this.data.count + 1
    db.collection(&#39;counters&#39;).doc(this.data.counterId).update({
      data: {
        count: newCount
      },
      success: res =&gt; {
        this.setData({
          count: newCount
        })
      },
      fail: err =&gt; {
        icon: &#39;none&#39;,
        console.error(&#39;[数据库] [更新记录] 失败：&#39;, err)
      }
    })
  },

  onCounterDec: function() {
    const db = wx.cloud.database()
    const newCount = this.data.count - 1
    db.collection(&#39;counters&#39;).doc(this.data.counterId).update({
      data: {
        count: newCount
      },
      success: res =&gt; {
        this.setData({
          count: newCount
        })
      },
      fail: err =&gt; {
        icon: &#39;none&#39;,
        console.error(&#39;[数据库] [更新记录] 失败：&#39;, err)
      }
    })
  },

   onRemove: function() {
    if (this.data.counterId) {
      const db = wx.cloud.database()
      db.collection(&#39;counters&#39;).doc(this.data.counterId).remove({
        success: res =&gt; {
          wx.showToast({
            title: &#39;删除成功&#39;,
          })
          this.setData({
            counterId: &#39;&#39;,
            count: null,
          })
        },
        fail: err =&gt; {
          wx.showToast({
            icon: &#39;none&#39;,
            title: &#39;删除失败&#39;,
          })
          console.error(&#39;[数据库] [删除记录] 失败：&#39;, err)
        }
      })
    } else {
      wx.showToast({
        title: &#39;无记录可删，请见创建一个记录&#39;,
      })
    }
  },</code></pre>
<h3 id="wx-request网络请求"><a href="#wx-request网络请求" class="headerlink" title="wx.request网络请求"></a>wx.request网络请求</h3><pre><code class="js">var that = this
wx.request({
    url:&#39;&#39;,
    method:&#39;GET&#39;,
    data:{
        x:1,
        y:2
    },
    header:{
        &quot;content-type&quot;:&quot;json&quot;
    },
    success:function(res){},
    fail:function(){},
    complete:function(){}
    }
})</code></pre>
<h3 id="要求合法域名"><a href="#要求合法域名" class="headerlink" title="要求合法域名"></a>要求合法域名</h3><h4 id="动态设置导航栏"><a href="#动态设置导航栏" class="headerlink" title="动态设置导航栏"></a>动态设置导航栏</h4><p>wx.showNavigationBarLoading(),<br>wx.hideNavigationBarLoading(),<br>wx.SetNavigationBarTitle(),</p>
<h4 id="页面事件处理函数"><a href="#页面事件处理函数" class="headerlink" title="页面事件处理函数"></a>页面事件处理函数</h4><p>onPullDownRefresh<br>onReachBottom<br>onPageScroll<br>onShareAppMessage</p>
<h3 id="弹性盒子布局"><a href="#弹性盒子布局" class="headerlink" title="弹性盒子布局"></a>弹性盒子布局</h3><p>更多内容：学堂在线→前端学习</p>
<h3 id="组件化开发"><a href="#组件化开发" class="headerlink" title="组件化开发"></a>组件化开发</h3><h4 id="自定义组件"><a href="#自定义组件" class="headerlink" title="自定义组件"></a>自定义组件</h4><p>wxml</p>
<pre><code class="xml">&lt;!-- 当自定义组件出发“myevent&quot;事件时，调用”onMyEvent&quot;方法 --&gt;
&lt;component-tag-name bindmyevent=&quot;onMyEvent&quot;&gt;
page({
    onMyevent:function(e){
        e.detail//自定义组件触发事件时提供的detail对象
    }
})
&lt;!-- 在自定义组件中 --&gt;
&lt;button bindtap=&quot;onTap&quot;&gt;点击这个按钮将触发&quot;myevent&quot;事件&lt;/button&gt;

Component({
    properties:{}
    methods:{
        onTap:function(){
            var myEventDetail = {}  //detail对象，提供给事件监听函数
            var myEventOption = {}  //触发事件的选项
            this.triggerEvent(&#39;myevent&#39;, myEventDetail,myEventOption)
        }
    }
})</code></pre>
<h2 id="疑问"><a href="#疑问" class="headerlink" title="疑问"></a>疑问</h2><h3 id=""><a href="#" class="headerlink" title=""></a></h3>
</div>


    <div class="post-guide">
        <div class="item left">
            
              <a href="/2020/04/23/webpack%E4%BD%BF%E7%94%A8/">
                  <i class="fa fa-angle-left" aria-hidden="true"></i>
                  webpack使用
              </a>
            
        </div>
        <div class="item right">
            
              <a href="/2020/04/23/thread/">
                thread
                <i class="fa fa-angle-right" aria-hidden="true"></i>
              </a>
            
        </div>
    </div>



	<div id="vcomments"></div>


<script>
	
		// 评论
		new Valine({
			av: AV,
			el: '#vcomments',
			notify: false,
			verify: false,
			path: window.location.pathname,
			appId: '',
			appKey: '',
			placeholder: '请输入评论',
			avatar: 'retro',
			recordIP: false
		})
	
	
</script>
	</div>
	<div id="footer">
	<p>
	©2019-<span id="footerYear"></span> 
	<a href="/">Been Stone</a> 
	
	
		|
		<span id="busuanzi_container_site_pv">
			pv
			<span id="busuanzi_value_site_pv"></span>
		</span>
		|
		<span id="busuanzi_container_site_uv"> 
			uv
			<span id="busuanzi_value_site_uv"></span>
		</span>
	
	<br>
	Theme <a href="//github.com/wujun234/hexo-theme-tree" target="_blank">Tree</a>
	by <a href="//github.com/wujun234" target="_blank">WuJun</a>
	Powered by <a href="//hexo.io" target="_blank">Hexo</a>
	</p>
</div>
<script type="text/javascript"> 
	document.getElementById('footerYear').innerHTML = new Date().getFullYear() + '';
</script>
	<button id="totop-toggle" class="toggle"><i class="fa fa-angle-double-up" aria-hidden="true"></i></button>
</body>
</html>